去中心化 dht  p2p


◇为啥会出现 DHT？
在 P2P 文件共享的发展史上，出现过3种不同的技术路线（三代）。

第1代
采用【中央服务器】的模式 — — 每个节点都需要先连接到中央服务器，然后才能查找到自己想要的文件在哪里。
这种技术的最大缺点是 — — 中央服务器成为整个 P2P 网络的【单点故障】。
（关于“单点故障”这个概念，可以看另一篇介绍：《聊聊“单点故障” — — 关于“德国空难”和“李光耀”的随想》）
这类 p2p 的典型代表是 Napster。

第2代
采用【广播】的模式 — — 要找文件的时候，每个节点都向自己相连的【所有节点】进行询问；被询问的节点如果不知道这个文件在哪里，就再次进行“广播”……如此往复，直至找到所需文件。
这种技术的最大缺点是 — — 会引发“广播风暴”并严重占用网络带宽，也会严重消耗节点的系统资源。即使在协议层面通过设置 TTL（time to live），限制查询过程只递归 N 轮，依然【无法】彻底解决此弊端。
因为这种手法太吓人，获得“Query Flooding”的绰号。下面放一张示意图。


（示意图：第2代 P2P 的 Query Flooding）
这类 p2p 的典型代表是 Gnutella 的早期版本。

第3代
这一代采用的技术就是今天要聊的 DHT。
通过 DHT 这个玩意儿，不但避免了第一代技术的【单点故障】，也避免了第二代技术的【广播风暴】。

◇DHT 有哪些应用场景？
DHT 最早用于 P2P 文件共享和文件下载（比如：BT、电驴、电骡），之后也被广泛用于某些分布式系统中，比如：



　再看看 I2P 为啥封杀不了：
　　I2P 使用 Kad 算法（用过电驴或电骡的网友，应该听说过）来获取网络节点的信息。这么做有几个好处：
1. 不需要目录服务器
2. Kad 算法拿到的节点信息只是整个 I2P 网络的一小部分
3. 每一台运行 I2P 的主机都可以成为中继，帮别人转发数据（类似于 P2P 下载）